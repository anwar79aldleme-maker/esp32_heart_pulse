<canvas id="ppg"></canvas>

<script>
let data=[], labels=[];
const MAX=300;

const chart = new Chart(ppg,{
  type:'line',
  data:{
    labels,
    datasets:[{
      data,
      borderColor:'#00ff9c',
      borderWidth:2,
      pointRadius:0,
      tension:0.3
    }]
  },
  options:{
    animation:false,
    scales:{
      x:{display:false},
      y:{min:300,max:800}
    }
  }
});

async function draw(){
  const r = await fetch('/api/pulse?last=1');
  const d = await r.json();
  if(!d.length) return;

  data.push(d[0].signal);
  labels.push('');

  if(data.length>MAX){
    data.shift();
    labels.shift();
  }

  chart.update();
}

setInterval(draw,20); // 50Hz
</script>
